<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Report 003004 contents // GHW - Circulation Transaction Log &mdash; Next Steps 1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/override.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Next Steps
            <img src="../_static/next.steps.logo.dark.1.1.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../foundations.html">Foundations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic.html">Koha basics for library staff</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about_us.html">About us</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usergroup/index.html">Usergroup meetings</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Highlighted training:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../staff_instruction_sheets/cataloging_freeze_withdrawn.html">Deleting items during the cataloging freeze work-around</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Upgrades:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../upgrades/21.11/master.html">21.11 Upgrade</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrades/22_05/22_05_master.html">22.05 Upgrade</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bugs:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../bugs/index.html">Bugs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reports:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reports_training/index.html">Reports training index</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Special documents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Next Steps</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Report 003004 contents // GHW - Circulation Transaction Log</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/reports/report_003004.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="report-003004-contents-ghw-circulation-transaction-log">
<h1>Report 003004 contents // GHW - Circulation Transaction Log<a class="headerlink" href="#report-003004-contents-ghw-circulation-transaction-log" title="Permalink to this heading"></a></h1>
<div class="section" id="report-technical-information-3004">
<h2>Report technical information: 3004<a class="headerlink" href="#report-technical-information-3004" title="Permalink to this heading"></a></h2>
<p>ID number: 3004</p>
<p>Name: GHW - Circulation Transaction Log</p>
<p>Group: Circulation</p>
<p>Created on: 2017-10-05 15:03:46</p>
<p>Modified on: 2020-02-18 15:02:02</p>
<p>Cache expiry in seconds: 300</p>
<p>Created by: gwilliams</p>
<p>This file generated: 2023-03-24 16:49:10</p>
<p>Notes:</p>
<div style="border: 1px solid black; padding: 25px;">

  <div id=reportinfo>
  <p>Generates a transaction log for all checkouts and renewals at a branch on one day</p>
  <ul><li>Shows a log for the date you specify</li>
  <li>Shows all of the checkouts and renewals at the branch you specify</li>
  <li>grouped by date, time, item barcode, and patron barcode</li>
  <li>sorted by date/time from newest to oldest</li>
  </ul><br />
  <p><ins>Notes:</ins></p>
  <p></p>
  <p>This report will only show the staff login for checkouts (renewals are not logged) but the way this report gathers data from the action logs is not perfect so you may see renewals with staff login information and checkouts with no staff login information.<br />
  Staff login information can only be recovered if the circulation occurred in the previous 60 days.  The table where that information is stored has data more than 60 days old purged on a daily basis.<br />
  Transaction history is only saved for the previous 25 months.  You cannot run this report to gather data more than 25 months old.<br />
  This report will only cover 1 day at a time.  Creating a report that generates a log for multiple days has the potential to disrupt the system.<br />
  </p>
  <p></p>
  <p><a href="/cgi-bin/koha/reports/guided_reports.pl?reports=3004&phase=Run%20this%20report"  target="_blank">Click here to run in a new window</a></p>
  </div>

</div></div>
<hr class="docutils" />
<div class="section" id="sql-3004">
<h2>SQL: 3004<a class="headerlink" href="#sql-3004" title="Permalink to this heading"></a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="w">  </span><span class="k">SELECT</span><span class="w"></span>
<span class="linenos"> 2</span><span class="w">    </span><span class="k">statistics</span><span class="p">.</span><span class="n">datetime</span><span class="p">,</span><span class="w"></span>
<span class="linenos"> 3</span><span class="w">    </span><span class="k">statistics</span><span class="p">.</span><span class="n">branch</span><span class="p">,</span><span class="w"></span>
<span class="linenos"> 4</span><span class="w">    </span><span class="n">actions</span><span class="p">.</span><span class="n">cardnumber</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">STAFF_LOGIN</span><span class="p">,</span><span class="w"></span>
<span class="linenos"> 5</span><span class="w">    </span><span class="k">statistics</span><span class="p">.</span><span class="k">type</span><span class="p">,</span><span class="w"></span>
<span class="linenos"> 6</span><span class="w">    </span><span class="k">Upper</span><span class="p">(</span><span class="n">items</span><span class="p">.</span><span class="n">barcode</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ITEM_BC</span><span class="p">,</span><span class="w"></span>
<span class="linenos"> 7</span><span class="w">    </span><span class="k">statistics</span><span class="p">.</span><span class="n">itemtype</span><span class="p">,</span><span class="w"></span>
<span class="linenos"> 8</span><span class="w">    </span><span class="k">statistics</span><span class="p">.</span><span class="n">ccode</span><span class="p">,</span><span class="w"></span>
<span class="linenos"> 9</span><span class="w">    </span><span class="k">Upper</span><span class="p">(</span><span class="n">borrowers</span><span class="p">.</span><span class="n">cardnumber</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PATRON_BC</span><span class="w"></span>
<span class="linenos">10</span><span class="w">  </span><span class="k">FROM</span><span class="w"></span>
<span class="linenos">11</span><span class="w">    </span><span class="k">statistics</span><span class="w"></span>
<span class="linenos">12</span><span class="w">    </span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">statistics</span><span class="p">.</span><span class="n">itemnumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">items</span><span class="p">.</span><span class="n">itemnumber</span><span class="w"></span>
<span class="linenos">13</span><span class="w">    </span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">borrowers</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">statistics</span><span class="p">.</span><span class="n">borrowernumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">borrowers</span><span class="p">.</span><span class="n">borrowernumber</span><span class="w"></span>
<span class="linenos">14</span><span class="w">    </span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"></span>
<span class="linenos">15</span><span class="w">          </span><span class="n">action_logs</span><span class="p">.</span><span class="k">timestamp</span><span class="p">,</span><span class="w"></span>
<span class="linenos">16</span><span class="w">          </span><span class="n">action_logs</span><span class="p">.</span><span class="k">object</span><span class="p">,</span><span class="w"></span>
<span class="linenos">17</span><span class="w">          </span><span class="n">action_logs</span><span class="p">.</span><span class="n">info</span><span class="p">,</span><span class="w"></span>
<span class="linenos">18</span><span class="w">          </span><span class="n">action_logs</span><span class="p">.</span><span class="n">module</span><span class="p">,</span><span class="w"></span>
<span class="linenos">19</span><span class="w">          </span><span class="n">action_logs</span><span class="p">.</span><span class="n">action</span><span class="p">,</span><span class="w"></span>
<span class="linenos">20</span><span class="w">          </span><span class="n">action_logs</span><span class="p">.</span><span class="k">user</span><span class="p">,</span><span class="w"></span>
<span class="linenos">21</span><span class="w">          </span><span class="n">borrowers</span><span class="p">.</span><span class="n">cardnumber</span><span class="w"></span>
<span class="linenos">22</span><span class="w">        </span><span class="k">FROM</span><span class="w"></span>
<span class="linenos">23</span><span class="w">          </span><span class="n">action_logs</span><span class="w"></span>
<span class="linenos">24</span><span class="w">          </span><span class="k">JOIN</span><span class="w"> </span><span class="n">borrowers</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">action_logs</span><span class="p">.</span><span class="k">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">borrowers</span><span class="p">.</span><span class="n">borrowernumber</span><span class="w"></span>
<span class="linenos">25</span><span class="w">        </span><span class="k">WHERE</span><span class="w"></span>
<span class="linenos">26</span><span class="w">          </span><span class="n">action_logs</span><span class="p">.</span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;circulation&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"></span>
<span class="linenos">27</span><span class="w">          </span><span class="p">(</span><span class="n">action_logs</span><span class="p">.</span><span class="n">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;issue&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"></span>
<span class="linenos">28</span><span class="w">           </span><span class="n">action_logs</span><span class="p">.</span><span class="n">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;renewal&#39;</span><span class="p">))</span><span class="w"> </span><span class="n">actions</span><span class="w"></span>
<span class="linenos">29</span><span class="w">    </span><span class="k">ON</span><span class="w"> </span><span class="k">statistics</span><span class="p">.</span><span class="n">itemnumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">actions</span><span class="p">.</span><span class="n">info</span><span class="w"></span>
<span class="linenos">30</span><span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="k">statistics</span><span class="p">.</span><span class="n">borrowernumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">actions</span><span class="p">.</span><span class="k">object</span><span class="w"></span>
<span class="linenos">31</span><span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="k">statistics</span><span class="p">.</span><span class="n">datetime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">actions</span><span class="p">.</span><span class="k">timestamp</span><span class="w"></span>
<span class="linenos">32</span><span class="w">  </span><span class="k">WHERE</span><span class="w"></span>
<span class="linenos">33</span><span class="w">    </span><span class="p">(</span><span class="k">statistics</span><span class="p">.</span><span class="k">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ISSUE&#39;</span><span class="w"> </span><span class="k">OR</span><span class="w"></span>
<span class="linenos">34</span><span class="w">      </span><span class="k">statistics</span><span class="p">.</span><span class="k">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;RENEW&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"></span>
<span class="linenos">35</span><span class="w">    </span><span class="k">statistics</span><span class="p">.</span><span class="n">branch</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="n">Choose</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">branch</span><span class="o">|</span><span class="n">ZBRAN</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="k">AND</span><span class="w"></span>
<span class="linenos">36</span><span class="w">    </span><span class="k">statistics</span><span class="p">.</span><span class="n">datetime</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="p">(</span><span class="o">@</span><span class="n">startdate</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="o">&lt;&lt;</span><span class="n">Choose</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nb">date</span><span class="o">|</span><span class="nb">date</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">DATE</span><span class="p">))</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">(</span><span class="k">CAST</span><span class="p">(</span><span class="o">@</span><span class="n">startdate</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">DATE</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">DAY</span><span class="p">)</span><span class="w"></span>
<span class="linenos">37</span><span class="w">  </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"></span>
<span class="linenos">38</span><span class="w">    </span><span class="k">statistics</span><span class="p">.</span><span class="n">datetime</span><span class="p">,</span><span class="w"></span>
<span class="linenos">39</span><span class="w">    </span><span class="n">ITEM_BC</span><span class="p">,</span><span class="w"></span>
<span class="linenos">40</span><span class="w">    </span><span class="n">PATRON_BC</span><span class="w"></span>
<span class="linenos">41</span><span class="w">  </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"></span>
<span class="linenos">42</span><span class="w">    </span><span class="k">statistics</span><span class="p">.</span><span class="n">datetime</span><span class="w"> </span><span class="k">DESC</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Northeast Kansas Library System.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
    <p><br /><a rel="license" href="http://creativecommons.org/licenses/by/4.0/" target="_blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br /><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/" target="_blank">Creative Commons Attribution 4.0 International License</a>.</p>
    <p>Next Search Catalog contact info:<br />NEKLS: 785-838-4090<br />(toll free: 888-296-6963)<br />After hours: 785-813-1356</p>
     <img src="https://raw.githubusercontent.com/northeast-kansas-library-system/nextimages/master/nexthelp.svg" alt="Nexthelp email address" />
     


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>